<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title>Products</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>



    <link href='/assets/demo-to-codepen.css' rel='stylesheet' />


    <style>
        header{
            max-width: 100%;
        }
        html, body {
            margin: 0;
            padding: 0;
            font-family: Arial, Helvetica Neue, Helvetica, sans-serif;
            font-size: 14px;

        }

        #calendar {
            max-width: 800px;
            margin-right:0px;
            max-height: 300px;
        }
        #container{
            margin:0 auto;
            max-width: 1000px;
        }


    </style>

    <link href='https://cdn.jsdelivr.net/npm/fullcalendar@5.5.1/main.min.css' rel='stylesheet' />
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@5.5.1/main.min.js'></script>







    <script src='/assets/demo-to-codepen.js'></script>


    <script src='https://unpkg.com/popper.js/dist/umd/popper.min.js'></script>
    <script src='https://unpkg.com/tooltip.js/dist/umd/tooltip.min.js'></script>
    <script th:inline="javascript">

        var post =[[${posts}]]

        console.log(post)

        document.addEventListener('DOMContentLoaded', function () {
            let calendarEl = document.getElementById('calendar');
            let calendar = new FullCalendar.Calendar(calendarEl, {

                eventRender: function(info) {
                    var tooltip = new Tooltip(info.el, {
                        title: info.event.description,
                        placement: 'top',
                        trigger: 'hover',
                        container: 'body'
                    });
                },

                eventClick: function (info) {

                    info.jsEvent.preventDefault();

                    var ids = info.event.id;

                    window.open("http://localhost:8080/posts/" + ids + "/readMore");


                },


                initialView: 'dayGridMonth',
                //initialDate: '2021-02-07',
                headerToolbar: {
                    left: 'prev,next today',
                    center: 'title',
                    right: 'dayGridMonth,timeGridWeek,timeGridDay'
                },
                events: [],


            });

            calendar.render();

            post.forEach(function (item) {
                var title = item.title;
                var shortDescription = item.shortDescription;
                var dateCreated = item.dateOfEvent;
                var id = item.id;
                var event = {id: id, title: title, start: dateCreated};

                calendar.addEvent(event);

            });

        });

    </script>


</head>
<div id="container">
    <div class="row">
        <div class="col">
            <p style="font-size: 30px">Donate for church:</p>
            <form method="POST" th:action="@{'/checkout'}">
                <input type="number" name="amount">
                <button class="btn btn-secondary btn-number" type="submit" >Confirm</button>
            </form>
        </div>
        <div class="col" id="calendar">
            <a href="/calendar"  style="   font-size: 25px;" >VIEW THE CHURCH EVENTS</a>
        </div>
    </div>

    <div class="content">
        <!-- The form below should invoke the method ProductsController.showProducts -->
        <a href="/posts/add" class="add-item" >
            Add new post
        </a>


        <div class="item" th:each="post: ${posts}">
            <div class="row">

                <div class="col-6 border" >
                    <img th:src="${post.getBase64Image()}"/>

                    <form method="POST" th:action="@{'/posts/{id}/review' (id=${post.id})}">

                        <input type='hidden' th:if="${#request.getRemoteUser() != null}"
                               th:value="${#request.getRemoteUser()}" name='email' />

                        <div>
                            <th:block th:if="${#request.getRemoteUser() != null}" >
                                <label>Rate post</label><br/>

                                <!-- For each category you should have one <option> like below  -->
                                <!-- <input  type="radio" id="rating" name="rating" th:each="rate:${rating}" th:value="${rate.name}" th:text="${rate.name}">-->

                                <select   id="rating" name="rating">
                                    <option  th:each="rate:${rating}" th:text="${rate.name}" th:name="${rate.name}" th:value="${rate.name}" >RATE</option>
                                </select>

                                <button type="submit" >Review</button>
                            </th:block>
                        </div>

                    </form>


                <div class="col-6 border">
                    <p th:text="${post.title}"></p>
                    <br />
                    <p th:text="${post.shortDescription}"></p>
                    <br />
                    <p th:text="${post.dateOfEvent}"></p>
                    <form method="POST" th:action="@{'/posts/{id}/delete' (id=${post.id})}"
                    >
                        <button type="submit" class="delete-item">Delete</button>
                    </form>
                    <!-- ProductsController.showEdit -->
                    <a th:href="@{'/posts/{id}/edit' (id=${post.id})}"class="edit-item"
                    >Edit </a>

                    <a th:href="@{'/posts/{id}/readMore' (id=${post.id})}" >Read More</a>
                </div>

            </form>
                    <!--    Subscription and upload file-->
                    <div class="newsletter-subscribe mt-5 container">
                        <div class="container">
                            <div class="intro">
                                <h2 class="text-center newsletter">Subscribe to our Newsletter</h2>
                            </div>
                            <form method="POST" th:action='@{/subscribers/save}' class="form-inline">
                                <div class="form-group">
                                    <input class="form-control" type="email" name="email" placeholder="Your Email">
                                </div>
                                <div class="form-group">
                                    <button class="btn btn-primary" type="submit">Subscribe </button>
                                </div>
                            </form>
                            <div th:if="${subscriberEmailError}">
                                <h1>Looks like you are already subscribed. Please check your email</h1>
                            </div>

                            <div th:if="${email}">
                                <h1>Thank you for subscribing</h1>
                            </div>
                        </div>
                    </div>

                    <br />

                    <form method="POST" th:action="@{/uploadFile}" enctype="multipart/form-data">
                        <input type="file" name="file"/>
                        <br/>
                        <br/>

                        <button type="submit">Submit</button>
                    </form>
                    <hr/>
                    <div th:if="${message}">
                        <h2 th:text="${message}"/>
                    </div>
                    <hr />
                    <a th:href="@{'/getPDF'}">Gemeindebrief</a>

                </div>
            </div>
        </div>
    </div>
</div>
</html>
